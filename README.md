Code that runs simulations for the paper: 
"**Measuring self-similarity in empirical signals to understand musical beat perception**"

Dependencies: 
* MATLAB >= 2018a
* R >= 4.3.2
* [acf_tools](https://github.com/TomasLenc/acf_tools)
* [rnb_tools](https://github.com/TomasLenc/rnb_tools)
* [letswave6](https://github.com/NOCIONS/letswave6)

The code was tested with Ubuntu 20.04 and macOS 13.6. 



<br> 

## Requirements


The analyses depend on several publicly available datasets. 


<br> 

**A test-retest resting and cognitive state EEG dataset**

The data is available on [openneuro](https://openneuro.org/datasets/ds004148) (number ds004148).  

The data can be conveniently obtained with [datalad](https://www.datalad.org/). Navigate to the project directory using the command line and the run the following: 

```bash
# install the dataset in current directory
datalad install https://github.com/OpenNeuroDatasets/ds004148.git

# only get the eyes-open data from session 1: 
datalad get sub-*/ses-session1/eeg/sub-*_ses-session1_task-eyesopen*

# in order to load without error, you need to unlock the files!!!
datalad unlock sub-*/ses-session1/eeg/sub-*_ses-session1_task-eyesopen*
```


<br> 

**InfantRhythm dataset** 

Available on [OSF](https://osf.io/9wf5u). Download raw data and run the analysis code to get the preprocessed data. You should see a folder in `derivatives/preprocessed_AB`. Copy it to the project directory. 



<br> 

**Lowhigh dataset**

The data can be downloaded from OSF (:exclamation: :exclamation: :exclamation:). 




<br> 

## Directory structure 

First, set up the paths to all required libraries, and the base path for the project in `get_par.m`. 

The variable `experiment_path` should point to the project directory that has the following structure (make sure you download all the required data):  


```
.
├── data
└── eeg
    ├── infant
    │   ├── Slaney_128coch_meddis_timeDomain_meanAcrossCF.mat
    │   └── derivatives
    │       └── preprocessed_AB
    │           ├── AB high sync P001.lw6
    │           ├── AB high sync P001.mat
    │           ├── AB high sync P002.lw6
    │           ├── AB high sync P002.mat
    │           ├── ...
    │           
    ├── lowhigh
    │   ├── Slaney_128coch_meddis_timeDomain_meanAcrossCF.mat
    │   ├── preprocessed
    │   │   ├── H_syncopated.lw6
    │   │   ├── H_syncopated.mat
    │   │   ├── ...
    │   │   
    │   └── tapping
    │       ├── 10_5.5.2017.1728.mat
    │       ├── 12_5.24.2017.1628.mat
    │       ├── ...
    │       
    └── resting_eeg
        └── ds004148
            ├── CHANGES
            ├── README
            ├── dataset_description.json
            ├── derivatives
            ├── participants.json
            ├── participants.tsv
            ├── sub-01
            ├── sub-02
            ├── sub-03
            ├── sub-04
     
```

<br> 

## Run analyses


Once everything is set up, run `main.m`. This will run all the simulations and save the data to disk. 

Once the simulations are run, generate the plots of the results using `main_plots.m`. 

Other plots required to assemble the figures in the paper are generated by individually running the scripts named `explain_<description>.m`. 

Finally, run `analysis.R` in R to generate rest of the figures and do statistical tests. 





